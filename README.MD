# 🎵 歌词视频生成器

一个用于生成歌词视频的Python桌面应用程序，支持单文件和批量处理模式，内置AI智能标题生成功能。

## ✨ 功能特色

- 🎬 **单文件模式**：生成单个歌词视频
- 📁 **批量处理**：一次性处理整个文件夹的音频和歌词文件
- 🤖 **AI智能标题**：基于OpenAI API自动生成视频标题和描述
- 🎨 **样式自定义**：丰富的字体、颜色、特效设置
- 📊 **实时进度**：详细的进度显示，支持当前文件和总体进度
- 🖼️ **智能背景**：自动提取音频封面或使用自定义背景图片
- 💾 **码率保持**：保持原音频文件的码率
- 🛑 **可控制**：支持中途停止处理
- 🎨 **样式导入/导出**：支持样式配置的导入和导出
- 💾 **自动保存**：样式设置自动保存到配置文件

## 🔧 系统要求

- Python 3.7+
- FFmpeg（需要安装在系统PATH中）
- Windows/Linux/MacOS

## 📦 安装

1. 克隆项目：
```bash
git clone https://github.com/jieyanwu/Lrc2Video.git
cd Lrc2Video
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 安装FFmpeg：
   - Windows: 下载FFmpeg并添加到PATH
   - Linux: `sudo apt install ffmpeg`
   - MacOS: `brew install ffmpeg`

## 🚀 使用方法

### 启动程序
```bash
python main.py
```

### 单文件模式
1. 在"文件选择"页面选择音频文件（.mp3/.flac/.wav/.m4a/.aac）
2. 选择对应的歌词文件（.lrc）
3. （可选）选择背景图片
4. 在"样式设置"页面自定义字体、颜色、特效
5. 点击"生成单个视频"

### 批量处理模式
1. 选择包含音频和歌词文件的文件夹
2. 点击"扫描"查看文件匹配情况
3. 在"样式设置"页面设置统一样式
4. 点击"批量生成视频"

## 📁 项目结构

```
Lrc2Video/
├── main.py                 # 主程序入口
├── requirements.txt        # 依赖文件
├── README.md              # 项目说明
├── config/                # 配置文件目录
│   └── config.json        # 用户配置文件
├── core/                  # 核心功能模块
│   ├── __init__.py
│   ├── video_generator.py # 视频生成器
│   └── ai_title_generator.py # AI标题生成器
├── gui/                   # GUI模块
│   ├── __init__.py
│   ├── main_window.py     # 主窗口
│   └── settings_window.py # 设置窗口
├── utils/                 # 工具模块
│   ├── __init__.py
│   ├── file_utils.py      # 文件处理工具
│   └── config_manager.py  # 配置管理器
└── output/               # 默认输出目录
```

## ⚙️ 配置说明

详细配置文档请参考 [CONFIG.md](CONFIG.md) 文件。

### AI标题设置
- **OpenAI API密钥**：在设置菜单中配置
- **启用AI标题**：可选择是否为每个视频生成智能标题
- **自定义提示词**：支持自定义AI生成标题的提示词

### 字体设置
- **字体族**：支持多种中英文字体
- **字体大小**：16-72像素可调
- **字体样式**：粗体、斜体支持
- **字体颜色**：自定义颜色选择

### 描边设置
- **描边宽度**：0-10像素可调
- **描边颜色**：自定义颜色选择

### 位置设置
- **底部边距**：调整字幕距离底部的距离

### 特效设置
- **淡入时间**：字幕出现时的淡入效果
- **淡出时间**：字幕消失时的淡出效果

### 视频设置
- **分辨率**：支持1920x1080、1280x720等常见分辨率
- **背景颜色**：无背景图片时使用的纯色背景

### 样式管理
- **导出样式**：将当前样式设置保存为JSON文件
- **导入样式**：从JSON文件导入样式配置
- **自动保存**：所有设置自动保存到配置文件

## 🎯 文件命名规则

程序会自动匹配同名的音频和歌词文件：
- `song.mp3` + `song.lrc` ✓
- `music.flac` + `music.lrc` ✓
- 背景图片：`song.jpg`/`song.png` 等同名图片文件

## 📊 进度显示

### 单文件模式
- 显示当前文件处理进度（0-100%）
- 实时状态信息

### 批量模式
- **当前文件进度**：当前正在处理文件的进度
- **总体进度**：已完成文件数/总文件数
- **详细日志**：每个文件的处理结果

## 🛠️ 故障排除

### 常见问题

1. **FFmpeg未找到**
   - 确保FFmpeg已正确安装并添加到系统PATH
   - 在命令行中测试：`ffmpeg -version`

2. **字幕样式不生效**
   - 检查字体是否在系统中存在
   - 尝试使用其他字体如"Microsoft YaHei"

3. **LRC文件编码错误**
   - 程序支持UTF-8、GBK等多种编码
   - 建议使用UTF-8编码保存LRC文件

4. **生成的视频没有声音**
   - 检查音频文件是否完整
   - 确认音频格式被FFmpeg支持

5. **AI标题生成功能无法使用**
   - 确保已正确配置OpenAI API密钥
   - 检查网络连接是否正常
   - 确认API密钥有足够的余额

6. **样式导入后未保存**
   - 导入样式后程序会自动保存到配置文件
   - 检查config/config.json文件是否有写入权限

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📮 联系方式

如有问题或建议，请通过GitHub Issues联系。